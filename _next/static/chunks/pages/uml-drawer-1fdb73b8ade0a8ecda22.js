(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[467],{5744:function(t,e,n){"use strict";n.r(e);var i=n(5893),a=n(7757),r=n.n(a),h=n(2137),o=n(6610),s=n(7294),c=n(5258),u=n(3642),l=n(4775),g=n(4456),d=n(1959),m=n(7239),f=n(2516),w=n(6869),v=n(4849),p=n(8884),x=n(4593),_=n(5639),y=n(7812),b=n(8358),j=n(6447),Z=n(2318),S=n(2571),k=n(7443),I=n(3907);function D(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return C(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return C(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var i=0,a=function(){};return{s:a,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,h=!0,o=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return h=t.done,t},e:function(t){o=!0,r=t},f:function(){try{h||null==n.return||n.return()}finally{if(o)throw r}}}}function C(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var T=function t(e,n,i,a,r,h){(0,o.Z)(this,t),this.cls=e,this.score=n,this.x=i,this.y=a,this.width=r,this.height=h};e.default=function(){var t=(0,s.useState)(!1),e=t[0],n=t[1],a=(0,s.useState)(null),o=a[0],C=a[1],E=(0,s.useState)("brush"),P=E[0],R=E[1],A=(0,s.useState)(!0),F=A[0],M=(A[1],(0,s.useState)(!1)),B=M[0],X=M[1],N=(0,s.useState)("architecture"),O=N[0],U=(N[1],(0,s.useState)("500x500")),Y=U[0],z=U[1],L=(0,s.useState)(!1),W=L[0],Q=L[1],$=(0,s.useState)(),q=$[0],G=$[1],H=(0,s.useState)(),J=H[0],K=H[1],V=(0,s.useState)(),tt=V[0],et=V[1],nt=(0,s.useState)(),it=nt[0],at=nt[1],rt=(0,s.useState)(),ht=rt[0],ot=rt[1],st=(0,s.useState)(),ct=st[0],ut=st[1],lt=(0,s.useState)([]),gt=lt[0],dt=lt[1],mt=(0,s.useState)(),ft=mt[0],wt=mt[1],vt=(0,s.useState)({x:0,y:0}),pt=(vt[0],vt[1]),xt=(0,s.useState)({x:0,y:0}),_t=xt[0],yt=xt[1],bt=(0,s.useState)([]),jt=bt[0],Zt=bt[1],St={1:{name:"user",width:100,height:100,path:"images/user.svg"},2:{name:"server",width:100,height:100,path:"images/server.svg"},3:{name:"database",width:100,height:100,path:"images/database.svg"},4:{name:"laptop",width:100,height:100,path:"images/laptop.svg"},5:{name:"mobile",width:100,height:100,path:"images/mobile.svg"},6:{name:"cloud",width:100,height:100,path:"images/cloud.svg"},7:{name:"file",width:100,height:100,path:"images/file.svg"},8:{name:"directory",width:100,height:100,path:"images/directory.svg"},25:{name:"text"},9:{name:"arrow_right",width:100,height:100,path:"images/arrow_right.svg"},10:{name:"arrow_left",width:100,height:100,path:"images/arrow_left.svg"},11:{name:"arrow_up",width:100,height:100,path:"images/arrow_up.svg"},12:{name:"arrow_down",width:100,height:100,path:"images/arrow_down.svg"},13:{name:"arrow_right_up",width:100,height:100,path:"images/arrow_right_up.svg"},14:{name:"arrow_right_down",width:100,height:100,path:"images/arrow_right_down.svg"},15:{name:"arrow_left_up",width:100,height:100,path:"images/arrow_left_up.svg"},16:{name:"arrow_left_down",width:100,height:100,path:"images/arrow_left_down.svg"},17:{name:"arrow_both_horizon",width:100,height:100,path:"images/arrow_both_horizon.svg"},18:{name:"arrow_both_vertical",width:100,height:100,path:"images/arrow_both_vertical.svg"},19:{name:"arrow_both_right_up",width:100,height:100,path:"images/arrow_both_right_up.svg"},20:{name:"arrow_both_right_down",width:100,height:100,path:"images/arrow_both_right_down.svg"},21:{name:"line_horizon",width:100,height:100,path:"images/line_horizon.svg"},22:{name:"line_vertical",width:100,height:100,path:"images/line_vertical.svg"},23:{name:"line_right_up",width:100,height:100,path:"images/line_right_up.svg"},24:{name:"line_right_down",width:100,height:100,path:"images/line_right_down.svg"},26:{name:"number_1",width:100,height:100,path:"images/number_1.svg"},27:{name:"number_2",width:100,height:100,path:"images/number_2.svg"},28:{name:"number_3",width:100,height:100,path:"images/number_3.svg"},29:{name:"number_4",width:100,height:100,path:"images/number_4.svg"},30:{name:"number_5",width:100,height:100,path:"images/number_5.svg"},31:{name:"number_6",width:100,height:100,path:"images/number_6.svg"},32:{name:"number_7",width:100,height:100,path:"images/number_7.svg"},33:{name:"number_8",width:100,height:100,path:"images/number_8.svg"},34:{name:"number_9",width:100,height:100,path:"images/number_9.svg"},35:{name:"number_10",width:100,height:100,path:"images/number_10.svg"}};(0,s.useEffect)((function(){if(!e){console.log("constructor");try{var t=document.getElementById("canvas"),i=document.createElement("canvas"),a=document.getElementById("canvas2"),r=[t.width,t.height];i.width=r[0],i.height=r[1],G(t),K(i),et(a);var h=t.getContext("2d");h&&at(h);var o=i.getContext("2d");o&&ot(o);var s=a.getContext("2d");s&&ut(s),Mt(t,i,h,o),S.CQI("webgl");var c=kt(O);(0,k.YL)(c).then((function(t){return wt(t)})),n(!0)}catch(u){console.log(u)}}}));var kt=function(t){return"tfjs_models/arc_model/model.json"},It=function(t,e){var n=e[t]?e[t]:null;return n&&n.path?n.path:""},Dt=function(t,e){if(it&&ht&&J){Q(!0),"brush"===P?(ht.strokeStyle="black",ht.lineWidth=1):"eraser"===P&&(ht.strokeStyle="white",ht.lineWidth=20);var n=Et(t,e);pt(n),yt(n),gt.push(ht.getImageData(0,0,J.width,J.height)),gt.length>20&&gt.shift()}},Ct=function(t,e){if(W){if(!ht||!it||!q)return;var n=Et(t,e);ht.beginPath(),ht.moveTo(_t.x,_t.y),ht.lineTo(n.x,n.y),ht.stroke(),it.putImageData(ht.getImageData(0,0,q.width,q.height),0,0),yt(n)}},Tt=function(){Q(!1),Pt()},Et=function(t,e){var n={x:0,y:0};return q&&(n={x:t-q.getBoundingClientRect().left,y:e-q.getBoundingClientRect().top}),n},Pt=function(){var t=(0,h.Z)(r().mark((function t(){var e;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(F){t.next=2;break}return t.abrupt("return");case 2:if(q&&(q.style.cursor="wait"),Zt([]),"architecture"!=O){t.next=11;break}return t.next=7,Rt(4,7,1);case 7:e=t.sent,At(e,St),Ft(e,St),Zt(e);case 11:q&&(q.style.cursor="auto");case 12:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Rt=function(){var t=(0,h.Z)(r().mark((function t(e,n,i){var a,h,o,s,c,u,l;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(q&&ft){t.next=2;break}return t.abrupt("return",[]);case 2:return a=S.Xhn.fromPixels(q),h=a.toInt().transpose([0,1,2]).expandDims(),t.next=6,ft.executeAsync(h);case 6:return o=t.sent,Array.isArray(o)||(o=[o]),s=o[e].arraySync(),c=o[n].arraySync(),u=o[i].dataSync(),l=[],c[0].forEach((function(t,e){if(t>.5){var n=s[0][e][0]*q.height,i=s[0][e][1]*q.width,a=s[0][e][2]*q.height,r=s[0][e][3]*q.width;l.push(new T(u[e],t.toFixed(4),i,n,r-i,a-n))}})),t.abrupt("return",l);case 14:case"end":return t.stop()}}),t)})));return function(e,n,i){return t.apply(this,arguments)}}(),At=function(t,e){if(B&&it){it.strokeStyle="#00FF00",it.font="21px serif",it.fillStyle="#00FF00";var n,i=D(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;it.strokeRect(a.x,a.y,a.width,a.height);var r=e[a.cls]?e[a.cls].name:"unknown",h=(100*Number(a.score)).toFixed(2);it.fillText("".concat(a.cls,": ").concat(r,", ").concat(h," %"),a.x,a.y)}}catch(o){i.e(o)}finally{i.f()}}},Ft=function(t,e){if(ct&&tt&&ht){ct.clearRect(0,0,tt.width,tt.height);var n,i=D(t);try{var a=function(){var t=n.value;if("text"==(e[t.cls]?e[t.cls].name:"unknown")){var i=ht.getImageData(t.x,t.y,t.width,t.height);ct.putImageData(i,t.x,t.y)}else{var a=It(t.cls,e);if(""!=a){var r=new Image;r.src=a,r.onload=function(){var e=t.x+t.width/2-r.width/2,n=t.y+t.height/2-r.height/2;ct.drawImage(r,e,n)}}}};for(i.s();!(n=i.n()).done;)a()}catch(r){i.e(r)}finally{i.f()}}},Mt=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;q&&it&&J&&ht&&(t=q,e=J,n=it,i=ht),t&&e&&n&&i&&(n.fillStyle="white",n.fillRect(0,0,t.width,t.height),i.fillStyle="white",i.fillRect(0,0,e.width,e.height)),dt([])},Bt=function(t,e){var n="".concat(t,"x").concat(e);if(Y!=n&&q&&it&&J&&ht&&tt&&ct){var i=it.getImageData(0,0,q.width,q.height),a=ht.getImageData(0,0,J.width,J.height),r=ct.getImageData(0,0,tt.width,tt.height),h=[t,e];q.width=h[0],q.height=h[1];var o=[t,e];J.width=o[0],J.height=o[1];var s=[t,e];tt.width=s[0],tt.height=s[1],Mt(),it.putImageData(i,0,0),ht.putImageData(a,0,0),ct.putImageData(r,0,0),z(n)}};return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(u.Z,{container:!0,children:[(0,i.jsx)(c.Z,{position:"static",children:(0,i.jsxs)(b.Z,{children:[(0,i.jsx)(Z.Z,{variant:"h6",children:"DegiThoth"}),(0,i.jsx)(j.ZP,{title:"Menu",children:(0,i.jsx)(y.Z,{onClick:function(t){C(t.currentTarget)},children:(0,i.jsx)(p.Z,{style:{color:"white"}})})}),(0,i.jsxs)(x.Z,{anchorEl:o,keepMounted:!0,open:Boolean(o),onClose:function(){C(null)},children:[(0,i.jsxs)(_.Z,{onClick:function(){X(!B)},children:[(0,i.jsx)(Z.Z,{variant:"inherit",children:"Display Detected"}),B?(0,i.jsx)(w.Z,{children:(0,i.jsx)(d.Z,{})}):null]}),(0,i.jsxs)(_.Z,{onClick:function(){Bt(500,500)},children:[(0,i.jsx)(Z.Z,{variant:"inherit",children:"500x500"}),"500x500"==Y?(0,i.jsx)(w.Z,{children:(0,i.jsx)(d.Z,{})}):null]}),(0,i.jsxs)(_.Z,{onClick:function(){Bt(700,500)},children:[(0,i.jsx)(Z.Z,{variant:"inherit",children:"700x500"}),"700x500"==Y?(0,i.jsx)(w.Z,{children:(0,i.jsx)(d.Z,{})}):null]})]}),(0,i.jsx)(j.ZP,{title:"Brush",children:(0,i.jsx)(y.Z,{onClick:function(){R("brush")},children:(0,i.jsx)(l.Z,{style:{color:"brush"==P?"red":"white"}})})}),(0,i.jsx)(j.ZP,{title:"Eraser",children:(0,i.jsx)(y.Z,{onClick:function(){R("eraser")},children:(0,i.jsx)(g.Z,{style:{color:"eraser"==P?"red":"white"}})})}),(0,i.jsx)(j.ZP,{title:"Download Image file",children:(0,i.jsx)(y.Z,{onClick:function(){tt&&tt.toBlob((function(t){var e=URL.createObjectURL(t),n=document.createElement("a");n.download="diagram.png",n.href=e,n.click(),n.remove()}),"image/png")},children:(0,i.jsx)(v.Z,{style:{color:"white"}})})}),(0,i.jsx)(j.ZP,{title:"Download pptx file",children:(0,i.jsx)(y.Z,{onClick:function(){!function(){var t,e=new I.Z,n=e.addSlide(),i=D(jt);try{for(i.s();!(t=i.n()).done;){var a=t.value;if("text"==(St[a.cls]?St[a.cls].name:"unknown")){if(ht){var r=document.createElement("canvas");r.width=a.width,r.height=a.height;var h=r.getContext("2d"),o=ht.getImageData(a.x,a.y,a.width,a.height);null===h||void 0===h||h.putImageData(o,0,0);var s=r.toDataURL(),c=a.x/100,u=a.y/100,l=a.width/100,g=a.height/100;n.addImage({data:s,x:c,y:u,w:l,h:g}),r.remove()}}else{var d=It(a.cls,St);if(""!=d){var m=(a.x+a.width/2-50)/100,f=(a.y+a.height/2-50)/100;n.addImage({path:d,x:m,y:f})}}}}catch(w){i.e(w)}finally{i.f()}e.writeFile()}()},children:(0,i.jsx)(m.Z,{style:{color:"white"}})})}),(0,i.jsx)(j.ZP,{title:"https://github.com/n-fukuju/shakyo",children:(0,i.jsx)(y.Z,{href:"https://github.com/n-fukuju/shakyo",children:(0,i.jsx)(f.Z,{style:{color:"white"}})})})]})}),(0,i.jsx)(u.Z,{item:!0,xs:6,children:(0,i.jsxs)(u.Z,{container:!0,children:[(0,i.jsx)(u.Z,{item:!0,xs:12,children:(0,i.jsx)(Z.Z,{variant:"caption",children:"Drawing Canvas"})}),(0,i.jsx)("canvas",{id:"canvas",width:"500",height:"500",onMouseDown:function(t){Dt(t.pageX,t.pageY)},onMouseMove:function(t){Ct(t.pageX,t.pageY)},onMouseUp:function(t){Tt()},onTouchStart:function(t){t.changedTouches.length>0&&Dt(t.changedTouches[0].pageX,t.changedTouches[0].pageY)},onTouchMove:function(t){t.changedTouches.length>0&&Ct(t.changedTouches[0].pageX,t.changedTouches[0].pageY)},onTouchEnd:function(t){Tt()},onTouchCancel:function(t){Tt()},style:{border:"1px solid black"}})]})}),(0,i.jsx)(u.Z,{item:!0,xs:6,children:(0,i.jsxs)(u.Z,{container:!0,children:[(0,i.jsx)(u.Z,{item:!0,xs:12,children:(0,i.jsx)(Z.Z,{variant:"caption",children:"Result"})}),(0,i.jsx)("canvas",{id:"canvas2",width:"500",height:"500",style:{border:"1px solid black"}})]})})]})})}},7377:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/uml-drawer",function(){return n(5744)}])},5410:function(){},8628:function(){},1601:function(){},7792:function(){},3180:function(){},7687:function(){},5042:function(){}},function(t){t.O(0,[774,491,452,958,828,913,888,179],(function(){return e=7377,t(t.s=e);var e}));var e=t.O();_N_E=e}]);