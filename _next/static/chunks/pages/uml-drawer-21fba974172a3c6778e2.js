(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[467],{5744:function(n,e,t){"use strict";t.r(e);var o=t(5893),a=t(7757),c=t.n(a),i=t(2137),r=t(7294),u=t(2571),h=t(7443);e.default=function(){var n,e,t,a,l,s=!1,f=[],g={x:0,y:0},d={x:0,y:0},w={1:{name:"usecase"},2:{name:"actor"},3:{name:"actor_with_label"},4:{name:"rectangle"},5:{name:"rectangle_with_label"},6:{name:"note"},7:{name:"arrow_right"},8:{name:"arrow_left"},9:{name:"arrow_up"},10:{name:"arrow_down"},11:{name:"arrow_right_up"},12:{name:"arrow_right_down"},13:{name:"arrow_left_up"},14:{name:"arrow_left_down"}};(0,r.useEffect)((function(){try{n=document.getElementById("canvas"),e=document.createElement("canvas");var o=[n.width,n.height];e.width=o[0],e.height=o[1];var c=n.getContext("2d");c&&(t=c);var i=e.getContext("2d");i&&(a=i),v(),u.CQI("webgl"),(0,h.YL)("tfjs_models/web_model/model.json").then((function(n){return l=n}))}catch(r){console.log(r)}}));var m=function(n,o){s=!0,t.strokeStyle="black",t.lineWidth=1,a.strokeStyle="black",a.lineWidth=1,g=_(n,o),d=g,f.push(a.getImageData(0,0,e.width,e.height))},p=function(e,o){if(s){var c=_(e,o);a.beginPath(),a.moveTo(d.x,d.y),a.lineTo(c.x,c.y),a.stroke(),t.putImageData(a.getImageData(0,0,n.width,n.height),0,0),d=c}},x=function(){s=!1,b()},_=function(e,t){return{x:e-n.getBoundingClientRect().left,y:t-n.getBoundingClientRect().top}},b=function(){var e=(0,i.Z)(c().mark((function e(){var o,a,i,r,h,s,f,g,d,m,p,x,_,b,v,y;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=u.Xhn.fromPixels(n),a=o.toInt().transpose([0,1,2]).expandDims(),e.next=4,l.executeAsync(a);case 4:for(i=e.sent,Array.isArray(i)||(i=[i]),r=i[1].arraySync(),h=i[2].arraySync(),s=i[5].dataSync(),f=[],h[0].forEach((function(e,t){if(e>.5){var o=[],a=r[0][t][0]*n.height,c=r[0][t][1]*n.width,i=r[0][t][2]*n.height,u=r[0][t][3]*n.width;o[0]=c,o[1]=a,o[2]=u-c,o[3]=i-a,f.push({class:s[t],score:e.toFixed(4),bbox:o})}})),g=0,d=f;g<d.length;g++)m=d[g],p=m.bbox[0],x=m.bbox[1],_=m.bbox[2],b=m.bbox[3],t.strokeStyle="#00FF00",t.strokeRect(p,x,_,b),t.font="21px serif",t.fillStyle="#00FF00",v=w[m.class].name,y=(100*m.score).toFixed(2),t.fillText("".concat(m.class,": ").concat(v,", ").concat(y," %"),p,x);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),v=function(){t.fillStyle="white",t.fillRect(0,0,n.width,n.height),a.fillStyle="white",a.fillRect(0,0,e.width,e.height)};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("p",{children:"canvas"}),(0,o.jsxs)("div",{children:[(0,o.jsx)("button",{onClick:function(){var e=new Image;e.src="temp/usecase_h06.png",e.onload=function(){t&&(n.width=e.width,n.height=e.height,t.drawImage(e,0,0),b())},console.log(n.toDataURL("image/svg+xml"))},children:"button"}),(0,o.jsx)("button",{onClick:function(){v()},children:"clear"}),(0,o.jsx)("button",{onClick:function(){!function(){if(f.length>0){var n=f.pop();n&&t.putImageData(n,0,0)}}()},children:"\u2190"}),(0,o.jsx)("a",{id:"download",onClick:function(e){console.log("download"),e.target.href=n.toDataURL("image/jpeg")},children:"DL\uff08\u53f3\u30af\u30ea\u30c3\u30af\uff09"})]}),(0,o.jsx)("canvas",{id:"canvas",width:"500",height:"500",onMouseDown:function(n){m(n.pageX,n.pageY)},onMouseMove:function(n){p(n.pageX,n.pageY)},onMouseUp:function(n){x()},onTouchStart:function(n){n.changedTouches.length>0&&m(n.changedTouches[0].pageX,n.changedTouches[0].pageY)},onTouchMove:function(n){n.changedTouches.length>0&&p(n.changedTouches[0].pageX,n.changedTouches[0].pageY)},onTouchEnd:function(n){x()},onTouchCancel:function(n){x()},style:{border:"1px solid black"}}),(0,o.jsx)("script",{})]})}},7377:function(n,e,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/uml-drawer",function(){return t(5744)}])},5410:function(){},8628:function(){},1601:function(){},7792:function(){},5042:function(){}},function(n){n.O(0,[803,774,888,179],(function(){return e=7377,n(n.s=e);var e}));var e=n.O();_N_E=e}]);