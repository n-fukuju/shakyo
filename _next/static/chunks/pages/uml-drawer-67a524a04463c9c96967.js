(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[467],{5744:function(t,e,n){"use strict";n.r(e);var i=n(5893),r=n(7757),a=n.n(r),h=n(2137),o=n(6610),s=n(5991),c=n(7294),u=n(3642),l=n(282),d=n(3258),f=n(5996),g=n(9446),w=n(4540),m=n(3098),x=n(3403),v=n(553),p=n(4436),y=n(5445),b=n(74),_=n(7162),k=n(2571),j=n(7443),S=n(3907),Z=n(7320),I=n.n(Z),C=n(1018),T=n.n(C);function D(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return E(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return E(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,h=!0,o=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return h=t.done,t},e:function(t){o=!0,a=t},f:function(){try{h||null==n.return||n.return()}finally{if(o)throw a}}}}function E(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var F="http://www.plantuml.com/plantuml/img/",A=function(){function t(e,n,i,r,a,h){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"";(0,o.Z)(this,t),this.cls=e,this.score=n,this.x=i,this.y=r,this.width=a,this.height=h,this.ref=s}return(0,s.Z)(t,[{key:"collision",value:function(t){return this.x<t.x+t.width&&this.x+this.width>t.width&&this.y<t.y+t.height&&this.y+this.height>t.y}},{key:"top",value:function(){return{x:this.x,y:this.y,width:this.width,height:0}}},{key:"top2",value:function(){return{x:this.x,y:this.y-this.height,width:this.width,height:this.height}}},{key:"bottom",value:function(){return{x:this.x,y:this.y+this.height,width:this.width,height:0}}},{key:"bottom2",value:function(){return{x:this.x,y:this.y+this.height+this.height,width:this.width,height:this.height}}},{key:"right",value:function(){return{x:this.x+this.width,y:this.y,width:0,height:this.height}}},{key:"right2",value:function(){return{x:this.x+this.width,y:this.y,width:this.width,height:this.height}}},{key:"left",value:function(){return{x:this.x,y:this.y,width:0,height:this.height}}},{key:"left2",value:function(){return{x:this.x-this.width,y:this.y,width:this.width,height:this.height}}},{key:"rightTop",value:function(){return{x:this.x+this.width/2,y:this.y,width:this.width/2,height:this.height/2}}},{key:"rightTop2",value:function(){return{x:this.x+this.width/2,y:this.y-this.y/2,width:this.width,height:this.height}}},{key:"rightBottom",value:function(){return{x:this.x+this.width/2,y:this.y+this.y/2,width:this.width/2,height:this.height/2}}},{key:"rightBottom2",value:function(){return{x:this.x+this.width/2,y:this.y+this.y/2,width:this.width,height:this.height}}},{key:"leftTop",value:function(){return{x:this.x,y:this.y,width:this.width/2,height:this.height/2}}},{key:"leftTop2",value:function(){return{x:this.x-this.width/2,y:this.y-this.height/2,width:this.width,height:this.height}}},{key:"leftBottom",value:function(){return{x:this.x,y:this.y+this.height/2,width:this.width/2,height:this.height/2}}},{key:"leftBottom2",value:function(){return{x:this.x-this.width/2,y:this.y+this.height/2,width:this.width,height:this.height}}}]),t}();e.default=function(){var t=(0,c.useState)(!1),e=t[0],n=t[1],r=(0,c.useState)("brush"),o=r[0],s=r[1],Z=(0,c.useState)(""),C=Z[0],E=Z[1],R=(0,c.useState)(""),B=R[0],X=R[1],L=(0,c.useState)(!0),N=L[0],M=L[1],O=(0,c.useState)("architecture"),U=O[0],Y=O[1],q=(0,c.useState)(!1),P=q[0],W=q[1],Q=(0,c.useState)(),z=Q[0],$=Q[1],G=(0,c.useState)(),H=G[0],J=G[1],K=(0,c.useState)(),V=K[0],tt=K[1],et=(0,c.useState)(),nt=et[0],it=et[1],rt=(0,c.useState)(),at=rt[0],ht=rt[1],ot=(0,c.useState)(),st=ot[0],ct=ot[1],ut=(0,c.useState)([]),lt=ut[0],dt=ut[1],ft=(0,c.useState)(),gt=ft[0],wt=ft[1],mt=(0,c.useState)({x:0,y:0}),xt=(mt[0],mt[1]),vt=(0,c.useState)({x:0,y:0}),pt=vt[0],yt=vt[1],bt=(0,c.useState)([]),_t=bt[0],kt=bt[1],jt={1:{name:"usecase"},2:{name:"actor"},3:{name:"actor_with_label"},4:{name:"rectangle"},5:{name:"rectangle_with_label"},6:{name:"note"},7:{name:"arrow_right"},8:{name:"arrow_left"},9:{name:"arrow_up"},10:{name:"arrow_down"},11:{name:"arrow_right_up"},12:{name:"arrow_right_down"},13:{name:"arrow_left_up"},14:{name:"arrow_left_down"}},St={1:{name:"participant"},2:{name:"actor"},3:{name:"actor_with_label"},4:{name:"database"},5:{name:"database_with_label"},6:{name:"lifeline"},7:{name:"arow_right"},8:{name:"arrow_right_with_label"},9:{name:"arrow_left"},10:{name:"arrow_left_with_label"},11:{name:"arrow_self"},12:{name:"arrow_self_with_label"}},Zt={1:{name:"user",width:100,height:100,path:"images/user.svg"},2:{name:"server",width:100,height:100,path:"images/server.svg"},3:{name:"database",width:100,height:100,path:"images/database.svg"},4:{name:"text"},5:{name:"arrow_right",width:100,height:100,path:"images/arrow_right.svg"},6:{name:"arrow_left",width:100,height:100,path:"images/arrow_left.svg"},7:{name:"arrow_up",width:100,height:100,path:"images/arrow_up.svg"},8:{name:"arrow_down",width:100,height:100,path:"images/arrow_down.svg"},9:{name:"arrow_right_up",width:100,height:100,path:"images/arrow_right_up.svg"},10:{name:"arrow_right_down",width:100,height:100,path:"images/arrow_right_down.svg"},11:{name:"arrow_left_up",width:100,height:100,path:"images/arrow_left_up.svg"},12:{name:"arrow_left_down",width:100,height:100,path:"images/arrow_left_down.svg"},13:{name:"number_1",width:100,height:100,path:"images/number_1"},14:{name:"number_2",width:100,height:100,path:"images/number_2"},15:{name:"number_3",width:100,height:100,path:"images/number_3"},16:{name:"number_4",width:100,height:100,path:"images/number_4"},17:{name:"number_5",width:100,height:100,path:"images/number_5"},18:{name:"number_6",width:100,height:100,path:"images/number_6"},19:{name:"number_7",width:100,height:100,path:"images/number_7"},20:{name:"number_8",width:100,height:100,path:"images/number_8"},21:{name:"number_9",width:100,height:100,path:"images/number_9"},22:{name:"number_10",width:100,height:100,path:"images/number_10"}},It=[7,8,9,10,11,12,13,14];(0,c.useEffect)((function(){if(!e){console.log("constructor");try{var t=document.getElementById("canvas"),i=document.createElement("canvas"),r=document.getElementById("canvas2"),a=[t.width,t.height];i.width=a[0],i.height=a[1],$(t),J(i),tt(r);var h=t.getContext("2d");h&&it(h);var o=i.getContext("2d");o&&ht(o);var s=r.getContext("2d");s&&ct(s),Ut(t,i,h,o),k.CQI("webgl");var c=Ct(U);(0,j.YL)(c).then((function(t){return wt(t)})),n(!0)}catch(u){console.log(u)}}}));var Ct=function(t){var e="tfjs_models/web_model/model.json";return"sequence"==t&&(e="tfjs_models/seq_model/model.json"),"architecture"==t&&(e="tfjs_models/arc_model/model.json"),e},Tt=function(t,e){var n=e[t]?e[t]:null;return n&&n.path?n.path:""},Dt=function(t,e){if(nt&&at&&H){W(!0),"brush"===o?(at.strokeStyle="black",at.lineWidth=1):"eraser"===o&&(at.strokeStyle="white",at.lineWidth=20);var n=At(t,e);xt(n),yt(n),lt.push(at.getImageData(0,0,H.width,H.height))}},Et=function(t,e){if(P){if(!at||!nt||!z)return;var n=At(t,e);at.beginPath(),at.moveTo(pt.x,pt.y),at.lineTo(n.x,n.y),at.stroke(),nt.putImageData(at.getImageData(0,0,z.width,z.height),0,0),yt(n)}},Ft=function(){W(!1),Rt()},At=function(t,e){var n={x:0,y:0};return z&&(n={x:t-z.getBoundingClientRect().left,y:e-z.getBoundingClientRect().top}),n},Rt=function(){var t=(0,h.Z)(a().mark((function t(){var e,n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(N){t.next=2;break}return t.abrupt("return");case 2:if(kt([]),"usecase"!=U){t.next=7;break}Bt(),t.next=23;break;case 7:if("sequence"!=U){t.next=15;break}return t.next=10,Xt(3,7,1);case 10:e=t.sent,console.log(e),Lt(e,St),t.next=23;break;case 15:if("architecture"!=U){t.next=23;break}return t.next=18,Xt(7,2,4);case 18:n=t.sent,console.log(n),Lt(n,Zt),Nt(n,Zt),kt(n);case 23:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Bt=function(){var t=(0,h.Z)(a().mark((function t(){var e,n,i,r,h,o,s,c,u,l,d,f;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(N){t.next=2;break}return t.abrupt("return");case 2:if(z&&nt&&gt){t.next=4;break}return t.abrupt("return");case 4:return e=k.Xhn.fromPixels(z),n=e.toInt().transpose([0,1,2]).expandDims(),t.next=8,gt.executeAsync(n);case 8:for(i=t.sent,Array.isArray(i)||(i=[i]),r=i[1].arraySync(),h=i[2].arraySync(),o=i[5].dataSync(),s=[],h[0].forEach((function(t,e){if(t>.5){var n=r[0][e][0]*z.height,i=r[0][e][1]*z.width,a=r[0][e][2]*z.height,h=r[0][e][3]*z.width;s.push(new A(o[e],t.toFixed(4),i,n,h-i,a-n))}})),c=0,u=s;c<u.length;c++)l=u[c],nt.strokeStyle="#00FF00",nt.strokeRect(l.x,l.y,l.width,l.height),nt.font="21px serif",nt.fillStyle="#00FF00",d=jt[l.cls].name,f=(100*Number(l.score)).toFixed(2),nt.fillText("".concat(l.cls,": ").concat(d,", ").concat(f," %"),l.x,l.y);Mt(s);case 17:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Xt=function(){var t=(0,h.Z)(a().mark((function t(e,n,i){var r,h,o,s,c,u,l;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(z&&gt){t.next=2;break}return t.abrupt("return",[]);case 2:return r=k.Xhn.fromPixels(z),h=r.toInt().transpose([0,1,2]).expandDims(),t.next=6,gt.executeAsync(h);case 6:return o=t.sent,Array.isArray(o)||(o=[o]),s=o[e].arraySync(),c=o[n].arraySync(),u=o[i].dataSync(),l=[],c[0].forEach((function(t,e){if(t>.5){var n=s[0][e][0]*z.height,i=s[0][e][1]*z.width,r=s[0][e][2]*z.height,a=s[0][e][3]*z.width;l.push(new A(u[e],t.toFixed(4),i,n,a-i,r-n))}})),t.abrupt("return",l);case 14:case"end":return t.stop()}}),t)})));return function(e,n,i){return t.apply(this,arguments)}}(),Lt=function(t,e){if(nt){nt.strokeStyle="#00FF00",nt.font="21px serif",nt.fillStyle="#00FF00";var n,i=D(t);try{for(i.s();!(n=i.n()).done;){var r=n.value;nt.strokeRect(r.x,r.y,r.width,r.height);var a=e[r.cls]?e[r.cls].name:"unknown",h=(100*Number(r.score)).toFixed(2);nt.fillText("".concat(r.cls,": ").concat(a,", ").concat(h," %"),r.x,r.y)}}catch(o){i.e(o)}finally{i.f()}}},Nt=function(t,e){if(st&&V&&at){st.clearRect(0,0,V.width,V.height);var n,i=D(t);try{var r=function(){var t=n.value;if("text"==(e[t.cls]?e[t.cls].name:"unknown")){var i=at.getImageData(t.x,t.y,t.width,t.height);st.putImageData(i,t.x,t.y)}else{var r=Tt(t.cls,e);if(""!=r){var a=new Image;a.src=r,a.onload=function(){var e=t.x+t.width/2-a.width/2,n=t.y+t.height/2-a.height/2;st.drawImage(a,e,n)}}}};for(i.s();!(n=i.n()).done;)r()}catch(a){i.e(a)}finally{i.f()}}},Mt=function(){var t=(0,h.Z)(a().mark((function t(e){var n,i,r,h,o,s,c,u,l,d,f,g,w,m;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n="",i=D(e),t.prev=2,i.s();case 4:if((r=i.n()).done){t.next=35;break}if(1!=(h=r.value).cls){t.next=14;break}return o=null===at||void 0===at?void 0:at.getImageData(h.x,h.y,h.width,h.height),t.next=10,Ot(o);case 10:return s=t.sent,h.ref="(".concat(s,")"),n+="".concat(h.ref,"\n"),t.abrupt("continue",33);case 14:if(2!=h.cls){t.next=18;break}return h.ref=":actor:",n+="".concat(h.ref,"\n"),t.abrupt("continue",33);case 18:if(!It.indexOf(h.cls)){t.next=33;break}if(c=null,u=null,!(h.cls=7)){t.next=27;break}l=D(e);try{for(l.s();!(d=l.n()).done;)((f=d.value).collision(h.right())||f.collision(h.right2()))&&(u=f),(f.collision(h.left())||f.collision(h.left2()))&&(c=f)}catch(a){l.e(a)}finally{l.f()}if(!c||""===c.ref||!u||""===u.ref){t.next=27;break}return n+="".concat(c.ref," --\x3e ").concat(u.ref,"\n"),t.abrupt("break",35);case 27:if(!(h.cls=9)){t.next=33;break}g=D(e);try{for(g.s();!(w=g.n()).done;)((m=w.value).collision(h.top())||m.collision(h.top2()))&&(u=m),(m.collision(h.bottom())||m.collision(h.bottom2()))&&(c=m)}catch(a){g.e(a)}finally{g.f()}if(!c||""===c.ref||!u||""===u.ref){t.next=33;break}return n+="".concat(c.ref," --\x3e ").concat(u.ref,"\n"),t.abrupt("break",35);case 33:t.next=4;break;case 35:t.next=40;break;case 37:t.prev=37,t.t0=t.catch(2),i.e(t.t0);case 40:return t.prev=40,i.f(),t.finish(40);case 43:E(n),""!=n&&X(F+T().encode(n));case 45:case"end":return t.stop()}}),t,null,[[2,37,40,43]])})));return function(e){return t.apply(this,arguments)}}(),Ot=function(){var t=(0,h.Z)(a().mark((function t(e){var n,i,r,h;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(H&&e){t.next=2;break}return t.abrupt("return");case 2:return(n=document.createElement("canvas")).width=e.width,n.height=e.height,null===(i=n.getContext("2d"))||void 0===i||i.putImageData(e,0,0),t.next=9,I().recognize(n,"eng");case 9:return r=t.sent,h=r.data.text,t.abrupt("return",h.replace(/[\n\(\)]/g,""));case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Ut=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;z&&nt&&H&&at&&(t=z,e=H,n=nt,i=at),t&&e&&n&&i&&(n.fillStyle="white",n.fillRect(0,0,t.width,t.height),i.fillStyle="white",i.fillRect(0,0,e.width,e.height)),dt([])};return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(u.Z,{container:!0,children:[(0,i.jsxs)(u.Z,{item:!0,xs:6,children:[(0,i.jsx)("p",{children:"canvas"}),(0,i.jsxs)("div",{children:[(0,i.jsx)(l.Z,{onClick:function(){Ut()},variant:"outlined",startIcon:(0,i.jsx)(f.Z,{}),children:"Clear"}),(0,i.jsx)(l.Z,{onClick:function(){!function(){if(lt.length>0){var t=lt.pop();t&&at&&nt&&(at.putImageData(t,0,0),nt.putImageData(t,0,0))}}()},variant:"outlined",children:(0,i.jsx)(g.Z,{})}),(0,i.jsx)(v.Z,{control:(0,i.jsx)(d.Z,{checked:N,onChange:function(t){M(t.target.checked)}}),label:"exec()"}),(0,i.jsxs)(y.Z,{value:U,onChange:function(t){Y(t.target.value),k.CQI("webgl");var e=Ct(t.target.value);(0,j.YL)(e).then((function(t){return wt(t)}))},children:[(0,i.jsx)("option",{value:"usecase",children:"Usecase"}),(0,i.jsx)("option",{value:"sequence",children:"Sequence"}),(0,i.jsx)("option",{value:"architecture",children:"architecture"})]}),(0,i.jsx)(l.Z,{onClick:function(){V&&V.toBlob((function(t){var e=URL.createObjectURL(t),n=document.createElement("a");n.download="diagram.png",n.href=e,n.click(),n.remove()}),"image/png")},variant:"outlined",children:"png DL"}),(0,i.jsx)(l.Z,{onClick:function(){!function(){var t,e=new S.Z,n=e.addSlide(),i=D(_t);try{for(i.s();!(t=i.n()).done;){var r=t.value;if("text"==(Zt[r.cls]?Zt[r.cls].name:"unknown")){if(at){var a=document.createElement("canvas");a.width=r.width,a.height=r.height;var h=a.getContext("2d"),o=at.getImageData(r.x,r.y,r.width,r.height);null===h||void 0===h||h.putImageData(o,0,0);var s=a.toDataURL(),c=r.x/100,u=r.y/100,l=r.width/100,d=r.height/100;n.addImage({data:s,x:c,y:u,w:l,h:d}),a.remove()}}else{var f=Tt(r.cls,Zt);if(""!=f){var g=(r.x+r.width/2-50)/100,w=(r.y+r.height/2-50)/100;n.addImage({path:f,x:g,y:w})}}}}catch(m){i.e(m)}finally{i.f()}e.writeFile()}()},variant:"outlined",children:"pptx DL"}),(0,i.jsx)(p.Z,{component:"fieldset",children:(0,i.jsxs)(_.Z,{row:!0,children:[(0,i.jsx)(v.Z,{label:"brush",control:(0,i.jsx)(b.Z,{value:"brush",checked:"brush"===o,onClick:function(){s("brush")},color:"primary",icon:(0,i.jsx)(w.Z,{color:"disabled"}),checkedIcon:(0,i.jsx)(w.Z,{})})}),(0,i.jsx)(v.Z,{value:"eraser",label:"eraser",control:(0,i.jsx)(b.Z,{value:"eraser",checked:"eraser"===o,onClick:function(){s("eraser")},color:"secondary",icon:(0,i.jsx)(m.Z,{color:"disabled"}),checkedIcon:(0,i.jsx)(m.Z,{})})})]})})]}),(0,i.jsx)("canvas",{id:"canvas",width:"500",height:"500",onMouseDown:function(t){Dt(t.pageX,t.pageY)},onMouseMove:function(t){Et(t.pageX,t.pageY)},onMouseUp:function(t){Ft()},onTouchStart:function(t){t.changedTouches.length>0&&Dt(t.changedTouches[0].pageX,t.changedTouches[0].pageY)},onTouchMove:function(t){t.changedTouches.length>0&&Et(t.changedTouches[0].pageX,t.changedTouches[0].pageY)},onTouchEnd:function(t){Ft()},onTouchCancel:function(t){Ft()},style:{border:"1px solid black"}})]}),(0,i.jsxs)(u.Z,{item:!0,xs:6,children:[(0,i.jsx)("p",{children:"view"}),(0,i.jsxs)(u.Z,{container:!0,children:[(0,i.jsx)(u.Z,{item:!0,xs:12,children:(0,i.jsx)(x.Z,{id:"text",fullWidth:!0,multiline:!0,variant:"outlined",value:C,onChange:function(t){E(t.target.value),""!=t.target.value&&X(F+T().encode(t.target.value))}})}),(0,i.jsx)(u.Z,{item:!0,xs:12,children:(0,i.jsx)("img",{src:B})})]}),(0,i.jsx)("p",{children:"canvas2"}),(0,i.jsx)("canvas",{id:"canvas2",width:"500",height:"500",style:{border:"1px solid black"}})]})]})})}},7377:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/uml-drawer",function(){return n(5744)}])},5410:function(){},8628:function(){},1601:function(){},7792:function(){},3180:function(){},7687:function(){},5042:function(){}},function(t){t.O(0,[774,491,447,80,57,870,888,179],(function(){return e=7377,t(t.s=e);var e}));var e=t.O();_N_E=e}]);